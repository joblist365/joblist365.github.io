#!/usr/bin/env python3
"""
DuckDuckGo Scraper for JobList365 (Free + Safe)
Reads:  Joblist365_data.csv
Writes: data/Joblist365_data_duckduck_updated_20.csv

Columns handled:
CompanyName, CompanyStateCode, CompanyIndustrialClassification, Website, Roles, LinkedIn
"""

import os
import re
import requests
import pandas as pd
from bs4 import BeautifulSoup
from urllib.parse import quote_plus
from concurrent.futures import ThreadPoolExecutor, as_completed

# ---------- CONFIG ----------
INPUT_PATH = "Joblist365_data.csv"
OUTPUT_PATH = "data/Joblist365_data_duckduck_updated_20.csv"
LIMIT = 10               # number of companies to process
MAX_WORKERS = 5          # number of parallel threads
HEADERS = {"User-Agent": "Mozilla/5.0 (compatible; JobList365Bot/1.0)"}
# ----------------------------

def duckduckgo_search(query):
    """Fetch HTML from DuckDuckGo search results."""
    url = f"https://duckduckgo.com/html/?q={quote_plus(query)}"
    try:
        r = requests.get(url, headers=HEADERS, timeout=15)
        if r.status_code == 200:
            return r.text
