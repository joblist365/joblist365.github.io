<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>JobPatra ‚Äì Results</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background-color: #f5f9ff;
    margin: 0;
    padding: 0;
    color: #222;
  }
  header {
    text-align: center;
    background-color: #1565c0;
    color: #fff;
    padding: 20px;
    font-size: 1.6rem;
    font-weight: bold;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  .note {
    background: #e3f2fd;
    color: #0d47a1;
    padding: 10px;
    border-radius: 8px;
    font-size: 0.95rem;
    text-align: center;
    margin: 10px auto;
    line-height: 1.4;
    max-width: 700px;
  }
  .back-btn {
    background-color: #2e7d32;
    color: #fff;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    font-size: 1.3rem;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
  }
  .container {
    max-width: 700px;
    margin: 20px auto;
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  .company-card {
    border: 1px solid #ccc;
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 15px;
    background: #f8fbff;
    transition: 0.2s;
    display: block;
  }
  .company-card.favorite-card {
    border-color: #e91e63;
    background: #fff0f4;
  }
  .company-card.dimmed {
    opacity: 0.45;
    filter: grayscale(100%);
  }
  .company-card:hover {
    background: #eaf3ff;
    transform: translateY(-2px);
  }
  .company-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .company-name {
    font-size: 1.1rem;
    font-weight: 700;
    color: #0d47a1;
  }
  .company-info {
    margin-top: 8px;
    color: #333;
    font-size: 0.95rem;
    line-height: 1.5;
  }
  .buttons {
    margin-top: 10px;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }
  .btn {
    border: none;
    border-radius: 6px;
    padding: 8px 12px;
    cursor: pointer;
    font-weight: 700;
    font-size: 0.9rem;
    color: #fff;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }
  .linkedin { background-color: #0a66c2; }
  .career { background-color: #1976d2; }
  .fav-btn { background-color: #e91e63; padding: 8px 10px; font-size: 1.1rem; }
  .fav-btn.active { background-color: #c2185b; }
  .na-btn { background-color: #9e9e9e; padding: 8px 10px; font-size: 1.1rem; }
  .meta { color: #555; font-size: 0.92rem; margin-top: 6px; }
  footer {
    text-align: center;
    font-size: 0.9rem;
    color: #777;
    padding: 20px;
    margin-top: 10px;
  }
  .ad-banner {
    text-align: center;
    margin-top: 20px;
  }
  .ad-banner img {
    width: 100%;
    max-width: 468px;
    border-radius: 8px;
    transition: opacity 0.5s ease;
  }
</style>
</head>

<body>
<header>üíº JobPatra</header>

<div class="note">
  <a href="index.html" class="back-btn">‚Üê</a>
  <span>‚≠ê Favorites always shown first</span>
</div>

<div class="container">
  <input id="searchBox" type="text" placeholder="Search by company or roles..." style="width:100%;padding:10px;border:1px solid #ccc;border-radius:8px;margin-bottom:15px;font-size:1rem;">

  <div id="results"></div>

  <div class="ad-banner">
    <img id="rotatingAd" src="https://via.placeholder.com/468x60.png?text=Ad+1" alt="Ad Banner">
  </div>
</div>

<footer>¬© 2025 JobPatra. All rights reserved.</footer>

<script>
  // === Auto Rotating Ads ===
  const ads = [
    "https://via.placeholder.com/468x60.png?text=Ad+1",
    "https://via.placeholder.com/468x60.png?text=Ad+2",
    "https://via.placeholder.com/468x60.png?text=Ad+3",
    "https://via.placeholder.com/468x60.png?text=Ad+4"
  ];
  let currentAd = 0;
  setInterval(() => {
    const adImg = document.getElementById("rotatingAd");
    currentAd = (currentAd + 1) % ads.length;
    adImg.style.opacity = 0;
    setTimeout(() => {
      adImg.src = ads[currentAd];
      adImg.style.opacity = 1;
    }, 500);
  }, 10000);
</script>

<!-- ‚úÖ DATA.JS LINK -->
<script src="data.js"></script>

<!-- ‚úÖ DISPLAY COMPANIES -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const resultsDiv = document.getElementById("results");
  const searchBox = document.getElementById("searchBox");

  // Combine all states into one list
  const allCompanies = [
    ...(window.andhraPradeshCompanies || []),
    ...(window.karnatakaCompanies || []),
    ...(window.maharashtraCompanies || []),
    ...(window.tamilNaduCompanies || []),
    ...(window.delhiCompanies || [])
  ];

  const LS_FAV = 'jobpatra_favorites_v1';
  const LS_NA = 'jobpatra_not_interested_v1';

  const loadLocal = key => JSON.parse(localStorage.getItem(key) || "[]");
  const saveLocal = (key, val) => localStorage.setItem(key, JSON.stringify(val));

  function render(companies) {
    resultsDiv.innerHTML = "";
    const favorites = loadLocal(LS_FAV);
    const notInterested = loadLocal(LS_NA);

    // sort favorites first
    const sorted = [
      ...companies.filter(c => favorites.includes(c.company)),
      ...companies.filter(c => !favorites.includes(c.company) && !notInterested.includes(c.company)),
      ...companies.filter(c => notInterested.includes(c.company))
    ];

    sorted.forEach(c => {
      const isFav = favorites.includes(c.company);
      const isNA = notInterested.includes(c.company);

      const card = document.createElement("div");
      card.className = "company-card" + (isFav ? " favorite-card" : "") + (isNA ? " dimmed" : "");

      card.innerHTML = `
        <div class="company-header">
          <div class="company-name">${c.company}</div>
          <div style="font-size:0.92rem;color:#666">${c.city}, ${c.state}</div>
        </div>
        <div class="company-info meta"><strong>Roles:</strong> ${c.roles.join(", ")}</div>
        <div class="buttons">
          <a class="btn linkedin" href="${c.linkedin}" target="_blank">LinkedIn</a>
          <a class="btn career" href="${c.career}" target="_blank">Career Page</a>
          <button class="btn fav-btn">${isFav ? '‚ù§Ô∏è' : 'ü§ç'}</button>
          <button class="btn na-btn">üö´</button>
        </div>
      `;

      card.querySelector(".fav-btn").addEventListener("click", () => {
        if (isFav) saveLocal(LS_FAV, favorites.filter(f => f !== c.company));
        else saveLocal(LS_FAV, [...favorites, c.company]);
        render(allCompanies);
      });

      card.querySelector(".na-btn").addEventListener("click", () => {
        if (isNA) saveLocal(LS_NA, notInterested.filter(f => f !== c.company));
        else saveLocal(LS_NA, [...notInterested, c.company]);
        render(allCompanies);
      });

      resultsDiv.appendChild(card);
    });
  }

  searchBox.addEventListener("input", e => {
    const val = e.target.value.toLowerCase();
    const filtered = allCompanies.filter(
      c =>
        c.company.toLowerCase().includes(val) ||
        c.roles.some(r => r.toLowerCase().includes(val))
    );
    render(filtered);
  });

  render(allCompanies);
});
</script>
</body>
</html>
