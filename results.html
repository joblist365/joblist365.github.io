<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JobPatra ‚Äì Search Results</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f5f9ff;
      margin: 0;
      padding: 0;
      color: #222;
    }
    header {
      text-align: center;
      background-color: #1565c0;
      color: #fff;
      padding: 20px;
      font-size: 1.6rem;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .note {
      background: #e3f2fd;
      color: #0d47a1;
      padding: 12px;
      border-radius: 8px;
      font-size: 0.95rem;
      text-align: center;
      margin: 15px auto;
      line-height: 1.5;
      max-width: 700px;
    }
    .container {
      max-width: 700px;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .company-card {
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      background: #f8fbff;
      transition: 0.2s;
      display: block;
    }
    .company-card.favorite-card { border-color: #e91e63; background: #fff0f4; }
    .company-card.dimmed { opacity: 0.45; filter: grayscale(100%); }
    .company-card:hover { background: #eaf3ff; transform: translateY(-2px); }
    .company-header { display: flex; justify-content: space-between; align-items: center; }
    .company-name { font-size: 1.1rem; font-weight: 700; color: #0d47a1; }
    .buttons { margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap; }
    .btn {
      border: none; border-radius: 6px; padding: 8px 12px;
      cursor: pointer; font-weight: 700; font-size: 0.9rem;
      color: #fff; text-decoration: none; display: inline-flex;
      align-items: center; gap: 8px;
    }
    .linkedin { background-color: #0a66c2; }
    .career { background-color: #1976d2; }
    .fav-btn { background-color: #e91e63; padding: 8px 10px; font-size: 1.1rem; }
    .na-btn { background-color: #9e9e9e; padding: 8px 10px; font-size: 1.1rem; }
    footer { text-align: center; font-size: 0.9rem; color: #777; padding: 20px; margin-top: 10px; }
    .counts { text-align: right; color: #666; font-size: 0.9rem; }
    .top-row { display:flex; justify-content:space-between; align-items:center; gap:10px; margin-bottom:12px; }
    .ad-banner { text-align:center; margin-top:15px; }
    .ad-banner img { width:100%; max-width:468px; border-radius:8px; }
    .back-home {
      background-color:#1976d2; color:#fff; border:none;
      padding:8px 14px; border-radius:8px; cursor:pointer;
      font-weight:bold; transition:0.2s;
    }
    .back-home:hover { background-color:#0d47a1; }
    @media (max-width:640px){ .top-row { flex-direction:column; align-items:stretch; } .counts { text-align:left; margin-top:8px; } }
  </style>
</head>
<body>
  <header>üíº JobPatra</header>
  <div class="note">Results (favorites always shown first). Use the back button to change filters.</div>

  <div class="container">
    <div class="top-row">
      <button class="back-home" onclick="window.location.href='index.html'">‚¨ÖÔ∏è Back</button>
      <div style="font-weight:700; color:#0d47a1">Matching Companies</div>
      <div class="counts" id="counts">Loading...</div>
    </div>
    <div id="results"></div>

    <div class="ad-banner">
      <img id="rotatingAd" src="https://via.placeholder.com/468x60.png?text=Your+Ad+Here" alt="Ad Banner">
    </div>
  </div>

  <footer>¬© 2025 JobPatra. All rights reserved.</footer>

  <script>
  // === Helper ===
  function getParam(name){const p=new URLSearchParams(window.location.search);return p.get(name)||"";}

  const filterSector=getParam('sector');
  const filterState=getParam('state');
  const filterCity=getParam('city');
  const filterRole=getParam('role');

  // === Sample Data ===
  const companies=[
    {name:"Infosys",sector:"Information Technology",state:"Karnataka",city:"Bangalore",roles:["Software Engineer","Data Analyst"],linkedin:"https://www.linkedin.com/company/infosys",career:"https://www.infosys.com/careers"},
    {name:"TCS",sector:"Information Technology",state:"Maharashtra",city:"Mumbai",roles:["Software Engineer","Data Analyst"],linkedin:"https://www.linkedin.com/company/tata-consultancy-services",career:"https://www.tcs.com/careers"},
    {name:"Wipro",sector:"Information Technology",state:"Andhra Pradesh",city:"Visakhapatnam",roles:["Software Engineer"],linkedin:"https://www.linkedin.com/company/wipro",career:"https://careers.wipro.com"},
    {name:"Apollo Hospitals",sector:"Healthcare",state:"Tamil Nadu",city:"Chennai",roles:["Medical Coder"],linkedin:"https://www.linkedin.com/company/apollo-hospitals",career:"https://www.apollohospitals.com/careers"},
    {name:"HDFC Bank",sector:"Finance",state:"Delhi",city:"New Delhi",roles:["Accountant"],linkedin:"https://www.linkedin.com/company/hdfc-bank",career:"https://www.hdfcbank.com/careers"}
  ];

  const LS_FAV='jobpatra_favorites_v1',LS_NA='jobpatra_not_interested_v1';
  const loadLocal=k=>JSON.parse(localStorage.getItem(k)||"[]");
  const saveLocal=(k,v)=>localStorage.setItem(k,JSON.stringify(v));

  function matchesFilters(c){
    if(filterSector && c.sector!==filterSector) return false;
    if(filterState && c.state!==filterState) return false;
    if(filterCity && c.city!==filterCity) return false;
    if(filterRole){
      const found=c.roles.some(r=>r.toLowerCase()===filterRole.toLowerCase()||r.toLowerCase().includes(filterRole.toLowerCase()));
      if(!found) return false;
    }
    return true;
  }

  const resultsDiv=document.getElementById('results');
  const counts=document.getElementById('counts');
  let favorites=loadLocal(LS_FAV),notInterested=loadLocal(LS_NA);

  function render(){
    resultsDiv.innerHTML="";
    const favSet=new Set(favorites),naSet=new Set(notInterested);
    const favList=[],normalList=[],naList=[];

    companies.forEach(c=>{
      const match=matchesFilters(c);
      const isFav=favSet.has(c.name),isNA=naSet.has(c.name);
      if(isFav){favList.push(c);}
      else if(match&&!isNA){normalList.push(c);}
      else if(isNA){naList.push(c);}
    });

    const final=[...favList,...normalList,...naList];
    counts.textContent=`${final.length} shown ‚Ä¢ ${favList.length} favorite`;

    final.forEach(c=>{
      const isFav=favSet.has(c.name),isNA=naSet.has(c.name);
      const card=document.createElement('div');
      card.className='company-card'+(isFav?' favorite-card':'')+(isNA&&!isFav?' dimmed':'');
      const rolesText=(c.roles||[]).join(', ');
      card.innerHTML=`
        <div class="company-header">
          <div class="company-name">${c.name}</div>
          <div style="font-size:0.9rem;color:#666">${c.city}, ${c.state}</div>
        </div>
        <div class="company-info"><strong>Role:</strong> ${rolesText}</div>
        <div class="buttons">
          <a class="btn linkedin" href="${c.linkedin}" target="_blank">LinkedIn</a>
          <a class="btn career" href="${c.career}" target="_blank">Career Page</a>
          <button class="btn fav-btn">${isFav?'‚ù§Ô∏è':'ü§ç'}</button>
          <button class="btn na-btn">üö´</button>
        </div>
      `;
      const favBtn=card.querySelector('.fav-btn');
      const naBtn=card.querySelector('.na-btn');
      favBtn.onclick=()=>{if(isFav){favorites=favorites.filter(x=>x!==c.name);}else{favorites.push(c.name);}saveLocal(LS_FAV,favorites);render();};
      naBtn.onclick=()=>{if(isNA){notInterested=notInterested.filter(x=>x!==c.name);}else{notInterested.push(c.name);}saveLocal(LS_NA,notInterested);render();};
      resultsDiv.appendChild(card);
    });
  }
  render();

  // === Rotating Ad every 10s ===
  const ads=[
    "https://via.placeholder.com/468x60.png?text=Your+Ad+Here",
    "https://via.placeholder.com/468x60.png?text=Post+Jobs+with+Us",
    "https://via.placeholder.com/468x60.png?text=Career+Guidance",
    "https://via.placeholder.com/468x60.png?text=Top+Hiring+Companies"
  ];
  let adIndex=0;
  setInterval(()=>{
    adIndex=(adIndex+1)%ads.length;
    document.getElementById('rotatingAd').src=ads[adIndex];
  },10000);
  </script>
</body>
</html>
